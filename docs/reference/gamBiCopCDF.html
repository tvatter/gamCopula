<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conditional distribution function of a Generalized Additive model for the   
copula parameter or Kendall's tau — gamBiCopCDF • gamCopula</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gamCopula</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tvatter/gamCopula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conditional distribution function of a Generalized Additive model for the   
copula parameter or Kendall's tau</h1>
    </div>

    
    <p>This function returns the distribution function of a bivariate conditional  
copula, where either the copula parameter or the Kendall's tau is modeled 
as a function of the covariates.</p>
    

    <pre class="usage"><span class='fu'>gamBiCopCDF</span>(<span class='no'>object</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code><a href='gamBiCop-class.html'>gamBiCop-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>(Same as in <code>predict.gam</code> from the 
<code><a href='http://www.rdocumentation.org/packages/mgcv/topics/mgcv-package'>mgcv</a></code> package) A matrix or data frame 
containing the values of the model covariates at which predictions are 
required. If this is not provided then the distribution corresponding to the 
original data are returned. If <code>newdata</code> is provided then it should contain all 
the variables needed for prediction: a warning is generated if not.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The conditional density.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='gamBiCop.html'>gamBiCop</a></code> and <code><a href='gamBiCopPredict.html'>gamBiCopPredict</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>require</span>(<span class='no'>copula</span>)
<span class='fu'>set.seed</span>(<span class='fl'>0</span>)

<span class='co'>## Simulation parameters (sample size, correlation between covariates,</span>
<span class='co'>## Gaussian copula family)</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>2e2</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>fam</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'>## A calibration surface depending on three variables</span>
<span class='no'>eta0</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>calib.surf</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
  <span class='no'>calib.quad</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>)/<span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> -(<span class='no'>b</span>/<span class='fl'>3</span>) * (<span class='no'>Tf</span>^<span class='fl'>2</span> - <span class='fl'>3</span> * <span class='no'>Tf</span> * <span class='no'>Tm</span> + <span class='fl'>3</span> * <span class='no'>Tm</span>^<span class='fl'>2</span>)
    <span class='fu'>return</span>(<span class='no'>a</span> + <span class='no'>b</span> * (<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span>)},
  <span class='no'>calib.sin</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>f</span> <span class='kw'>=</span> <span class='fl'>1</span>) {
    <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>b</span> * (<span class='fl'>1</span> - <span class='fl'>2</span> * <span class='no'>Tf</span> * <span class='no'>pi</span>/(<span class='no'>f</span> * <span class='no'>Tf</span> * <span class='no'>pi</span> +
                                 <span class='fu'>cos</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>Tf</span> - <span class='no'>Ti</span>))
                               - <span class='fu'>cos</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * <span class='no'>Ti</span>)))
    <span class='fu'>return</span>((<span class='no'>a</span> + <span class='no'>b</span>)/<span class='fl'>2</span> + (<span class='no'>b</span> - <span class='no'>a</span>) * <span class='fu'>sin</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>t</span> - <span class='no'>Ti</span>))/<span class='fl'>2</span>)},
  <span class='no'>calib.exp</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>s</span> <span class='kw'>=</span> <span class='no'>Tf</span>/<span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>)/<span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> (<span class='no'>b</span> * <span class='no'>s</span> * <span class='fu'>sqrt</span>(<span class='fl'>2</span> * <span class='no'>pi</span>)/<span class='no'>Tf</span>) * (<span class='fu'>pnorm</span>(<span class='fl'>0</span>, <span class='no'>Tm</span>, <span class='no'>s</span>) - <span class='fu'>pnorm</span>(<span class='no'>Tf</span>, <span class='no'>Tm</span>, <span class='no'>s</span>))
    <span class='fu'>return</span>(<span class='no'>a</span> + <span class='no'>b</span> * <span class='fu'>exp</span>(-(<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span>/(<span class='fl'>2</span> * <span class='no'>s</span>^<span class='fl'>2</span>)))})

<span class='co'>## 3-dimensional matrix X of covariates</span>
<span class='no'>covariates.distr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/Mvdc'>mvdc</a></span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/ellipCopula'>normalCopula</a></span>(<span class='no'>rho</span>, <span class='kw'>dim</span> <span class='kw'>=</span> <span class='fl'>3</span>),
                                 <span class='fu'>c</span>(<span class='st'>"unif"</span>), <span class='fu'>list</span>(<span class='fu'>list</span>(<span class='kw'>min</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>1</span>)),
                                 <span class='kw'>marginsIdentical</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/Mvdc'>rMvdc</a></span>(<span class='no'>n</span>, <span class='no'>covariates.distr</span>)
<span class='fu'>colnames</span>(<span class='no'>X</span>) <span class='kw'>&lt;-</span> <span class='fu'>paste</span>(<span class='st'>"x"</span>,<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)

<span class='co'>## U in [0,1]x[0,1] with copula parameter depending on X</span>
<span class='no'>U</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='condBiCopSim.html'>condBiCopSim</a></span>(<span class='no'>fam</span>, <span class='kw'>function</span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>) {<span class='no'>eta0</span>+<span class='fu'>sum</span>(<span class='fu'>mapply</span>(<span class='kw'>function</span>(<span class='no'>f</span>,<span class='no'>x</span>)
  <span class='fu'>f</span>(<span class='no'>x</span>), <span class='no'>calib.surf</span>, <span class='fu'>c</span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>)))}, <span class='no'>X</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='kw'>par2</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>return.par</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Merge U and X</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>U</span>$<span class='no'>data</span>,<span class='no'>X</span>)
<span class='fu'>names</span>(<span class='no'>data</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>paste</span>(<span class='st'>"u"</span>,<span class='fl'>1</span>:<span class='fl'>2</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>),<span class='fu'>paste</span>(<span class='st'>"x"</span>,<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>))

<span class='co'>## Model fit with penalized cubic splines (via min GCV)</span>
<span class='no'>basis</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>10</span>, <span class='fl'>10</span>)
<span class='no'>formula</span> <span class='kw'>&lt;-</span> ~<span class='fu'>s</span>(<span class='no'>x1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>1</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>2</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x3</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>3</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>)
<span class='fu'>system.time</span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gamBiCopFit.html'>gamBiCopFit</a></span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='no'>fam</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.335   0.009   0.344 </div><div class='input'>
<span class='co'>## Evaluate the conditional density</span>
<span class='fu'>gamBiCopCDF</span>(<span class='no'>fit</span>$<span class='no'>res</span>)</div><div class='output co'>#&gt;   [1] 0.0198474375 0.6717537658 0.6685440525 0.8345873257 0.8288132359
#&gt;   [6] 0.1235910766 0.3441990142 0.0931108177 0.5371458487 0.0326774029
#&gt;  [11] 0.0259161934 0.0377845745 0.4509528719 0.0138858221 0.3480052303
#&gt;  [16] 0.4402536121 0.2161366785 0.0016261750 0.1521913659 0.2440282674
#&gt;  [21] 0.3294484333 0.3719879929 0.2957705670 0.5313398868 0.7566311632
#&gt;  [26] 0.0243851130 0.0955629741 0.8173055113 0.1199735852 0.4009586262
#&gt;  [31] 0.0622281033 0.5543639528 0.1511671716 0.2644151328 0.5553504298
#&gt;  [36] 0.1661333398 0.3235422624 0.8569511730 0.1808727492 0.6168688631
#&gt;  [41] 0.0099209913 0.4246454533 0.6223504187 0.1060099016 0.6193154126
#&gt;  [46] 0.1098135079 0.8964376697 0.0536940127 0.3790518202 0.1528715314
#&gt;  [51] 0.0194698895 0.0880012963 0.9738834597 0.1024866326 0.4712303592
#&gt;  [56] 0.0048217453 0.3219375695 0.6458725253 0.3022159033 0.1280493367
#&gt;  [61] 0.3938457411 0.0965470296 0.2201418364 0.3321879357 0.0119953113
#&gt;  [66] 0.8382381448 0.5141623637 0.3232156953 0.5513177846 0.9094837475
#&gt;  [71] 0.0417468334 0.1491592997 0.0848606389 0.0184211738 0.1475870185
#&gt;  [76] 0.4827166412 0.0277150043 0.0442711944 0.1607491179 0.0528071527
#&gt;  [81] 0.9123747087 0.2834527256 0.0346594904 0.2685566180 0.1052068757
#&gt;  [86] 0.2012448481 0.0802050066 0.3464284716 0.7555537014 0.4262663030
#&gt;  [91] 0.5681282335 0.6173471660 0.0305412671 0.0856821681 0.5049142300
#&gt;  [96] 0.4368720322 0.0040903705 0.9445065259 0.1772638256 0.6066537144
#&gt; [101] 0.1132383913 0.6463693253 0.2849581116 0.6005626829 0.0220945385
#&gt; [106] 0.0257241932 0.2874825659 0.3583115960 0.5341512750 0.3833252263
#&gt; [111] 0.3749509560 0.6787883055 0.1557347164 0.0092346646 0.3573093619
#&gt; [116] 0.0512652071 0.7721101236 0.3568639660 0.3086761572 0.9001894702
#&gt; [121] 0.1824546365 0.0687378171 0.6644245674 0.2206306100 0.1114148343
#&gt; [126] 0.2450142303 0.1195683798 0.6348976301 0.0736029194 0.0089034132
#&gt; [131] 0.5231052513 0.4191334309 0.3087568699 0.0944031781 0.5283637504
#&gt; [136] 0.1040881634 0.5251563778 0.0154027157 0.2684306439 0.2635202325
#&gt; [141] 0.3683145107 0.0030515943 0.3481829420 0.4151551369 0.6928313906
#&gt; [146] 0.2197741788 0.1571349383 0.3791930871 0.6612060001 0.8779142171
#&gt; [151] 0.0298212350 0.7401627441 0.3025652182 0.3399796660 0.1900857820
#&gt; [156] 0.0231475565 0.6479278942 0.8367285201 0.2972243388 0.2672207409
#&gt; [161] 0.4121781158 0.3797378066 0.0112251727 0.1262510428 0.7545334331
#&gt; [166] 0.8872254648 0.2747487605 0.0522422264 0.0779799630 0.4700939776
#&gt; [171] 0.0706914601 0.0006675355 0.7895479317 0.3743260487 0.3768860792
#&gt; [176] 0.1698229332 0.0897216653 0.2157991970 0.7839786382 0.9695606129
#&gt; [181] 0.5005304386 0.7630667689 0.0212698039 0.7220052649 0.8567693316
#&gt; [186] 0.0233138132 0.2111615534 0.5491288271 0.9636177902 0.1002917085
#&gt; [191] 0.6855137451 0.8972648574 0.5182638278 0.6045079364 0.3383737628
#&gt; [196] 0.2850117547 0.6727221045 0.0420619042 0.0013328707 0.2277666265</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas Nagler, Thibault Vatter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
