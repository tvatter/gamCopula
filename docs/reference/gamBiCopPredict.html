<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict method of a Generalized Additive model for the copula parameter
or Kendall's tau — gamBiCopPredict • gamCopula</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict method of a Generalized Additive model for the copula parameter
or Kendall's tau — gamBiCopPredict" />
<meta property="og:description" content="Predict method of a Generalized Additive model for the copula parameter
or Kendall's tau" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gamCopula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tvatter/gamCopula">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict method of a Generalized Additive model for the copula parameter
or Kendall's tau</h1>
    <small class="dont-index">Source: <a href='https://github.com/tvatter/gamCopula/blob/master/R/gamBiCopPredict.R'><code>R/gamBiCopPredict.R</code></a></small>
    <div class="hidden name"><code>gamBiCopPredict.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict method of a Generalized Additive model for the copula parameter
or Kendall's tau</p>
    </div>

    <pre class="usage"><span class='fu'>gamBiCopPredict</span>(
  <span class='no'>object</span>,
  <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"calib"</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"link"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code><a href='gamBiCop-class.html'>gamBiCop-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>(Same as in <code>predict.gam</code> from the
<code><a href='https://rdrr.io/pkg/mgcv/man/mgcv-package.html'>mgcv</a></code> package) A matrix or data frame
containing the values of the model covariates at which predictions are
required. If this is not provided then predictions corresponding to the
original data are returned. If <code>newdata</code> is provided then it should contain all
the variables needed for prediction: a warning is generated if not.</p></td>
    </tr>
    <tr>
      <th>target</th>
      <td><p>Either <code>'calib'</code>, <code>'par'</code> or <code>'tau'</code> or a
combination of those. <code>'calib'</code> (default) corresponds to the calibration
function, <code>'par'</code> to the copula parameter and
<code>'tau'</code> to Kendall's tau.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>In (0,1) to return the corresponding confidence interval.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>(Similar as in <code>predict.gam</code> from the
<code><a href='https://rdrr.io/pkg/mgcv/man/mgcv-package.html'>mgcv</a></code> package, only active for
<code>type = 'calib'</code>). When this has the value <code>'link'</code> (default), the
calibration function is returned.  When <code>type = 'terms'</code> each component
of the linear predictor is returned separately (possibly with standard
errors): this includes parametric model components, followed by each smooth
component, but excludes any offset and any intercept. When
<code>type = 'lpmatrix'</code> then a matrix is returned which yields the values of
the linear predictor (minus any offset) when post-multiplied by the parameter
vector (in this case alpha is ignored).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>target = 'calib'</code>, then a list with 1 item <code>calib</code>.
If <code>target = 'par'</code>, <code>target = 'tau'</code> or
<code>target = c('par', 'tau')</code>,
then a list with 2, 2 or 3 items, namely <code>calib</code> and <code>par</code>,
<code>tau</code> and <code>par</code>, or  <code>calib</code>, <code>tau</code> and <code>par</code>.</p>
<p>If <code>alpha</code> is in (0,1), then a additional items of the list are
<code>calib.CI</code> as well as e.g. <code>par.CI</code> and/or <code>tau.CI</code> depending
on the value of <code>target</code>.</p>
<p>Otherwise, if <code>type = 'lpmatrix'</code> (only active for
<code>type = 'calib'</code>), then a matrix is returned which will give a vector of
linear predictor values (minus any offset) at the supplied covariate values,
when applied to the model coefficient vector (similar as
<code>predict.gam</code> from the <code><a href='https://rdrr.io/pkg/mgcv/man/mgcv-package.html'>mgcv</a></code>).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gamBiCop.html'>gamBiCop</a></code> and <code><a href='gamBiCopFit.html'>gamBiCopFit</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>copula</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>0</span>)

<span class='co'>## Simulation parameters (sample size, correlation between covariates,</span>
<span class='co'>## Clayton copula family)</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>5e2</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>fam</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'>## A calibration surface depending on three variables</span>
<span class='no'>eta0</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>calib.surf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='no'>calib.quad</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>) / <span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> -(<span class='no'>b</span> / <span class='fl'>3</span>) * (<span class='no'>Tf</span>^<span class='fl'>2</span> - <span class='fl'>3</span> * <span class='no'>Tf</span> * <span class='no'>Tm</span> + <span class='fl'>3</span> * <span class='no'>Tm</span>^<span class='fl'>2</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>a</span> + <span class='no'>b</span> * (<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span>)
  },
  <span class='no'>calib.sin</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>f</span> <span class='kw'>=</span> <span class='fl'>1</span>) {
    <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>b</span> * (<span class='fl'>1</span> - <span class='fl'>2</span> * <span class='no'>Tf</span> * <span class='no'>pi</span> / (<span class='no'>f</span> * <span class='no'>Tf</span> * <span class='no'>pi</span> +
      <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>Tf</span> - <span class='no'>Ti</span>))
      - <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * <span class='no'>Ti</span>)))
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>((<span class='no'>a</span> + <span class='no'>b</span>) / <span class='fl'>2</span> + (<span class='no'>b</span> - <span class='no'>a</span>) * <span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>t</span> - <span class='no'>Ti</span>)) / <span class='fl'>2</span>)
  },
  <span class='no'>calib.exp</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>s</span> <span class='kw'>=</span> <span class='no'>Tf</span> / <span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>) / <span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> (<span class='no'>b</span> * <span class='no'>s</span> * <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fl'>2</span> * <span class='no'>pi</span>) / <span class='no'>Tf</span>) * (<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span>(<span class='fl'>0</span>, <span class='no'>Tm</span>, <span class='no'>s</span>) - <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span>(<span class='no'>Tf</span>, <span class='no'>Tm</span>, <span class='no'>s</span>))
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>a</span> + <span class='no'>b</span> * <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span> / (<span class='fl'>2</span> * <span class='no'>s</span>^<span class='fl'>2</span>)))
  }
)

<span class='co'>## 3-dimensional matrix X of covariates</span>
<span class='no'>covariates.distr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/copula/man/Mvdc.html'>mvdc</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/copula/man/ellipCopula.html'>normalCopula</a></span>(<span class='no'>rho</span>, <span class='kw'>dim</span> <span class='kw'>=</span> <span class='fl'>3</span>),
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"unif"</span>), <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>min</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>1</span>)),
  <span class='kw'>marginsIdentical</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/copula/man/Mvdc.html'>rMvdc</a></span>(<span class='no'>n</span>, <span class='no'>covariates.distr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>X</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"x"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>""</span>)

<span class='co'>## U in [0,1]x[0,1] with copula parameter depending on X</span>
<span class='no'>U</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='condBiCopSim.html'>condBiCopSim</a></span>(<span class='no'>fam</span>, <span class='kw'>function</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>x3</span>) {
  <span class='no'>eta0</span> + <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span>(<span class='kw'>function</span>(<span class='no'>f</span>, <span class='no'>x</span>)
    <span class='fu'>f</span>(<span class='no'>x</span>), <span class='no'>calib.surf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='no'>x3</span>)))
}, <span class='no'>X</span>[, <span class='fl'>1</span>:<span class='fl'>3</span>], <span class='kw'>par2</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>return.par</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Merge U and X</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>U</span>$<span class='no'>data</span>, <span class='no'>X</span>)
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>data</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"u"</span>, <span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>""</span>), <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"x"</span>, <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>""</span>))

<span class='co'>## Model fit with penalized cubic splines (via min GCV)</span>
<span class='no'>basis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>10</span>, <span class='fl'>10</span>)
<span class='no'>formula</span> <span class='kw'>&lt;-</span> ~ <span class='fu'>s</span>(<span class='no'>x1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>1</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>2</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x3</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>3</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gamBiCopFit.html'>gamBiCopFit</a></span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='no'>fam</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.258   0.000   0.259 </div><div class='input'>
<span class='co'>## Extract the gamBiCop objects and show various methods</span>
(<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='no'>res</span>)</div><div class='output co'>#&gt; Gaussian copula with tau(z) = (exp(z)-1)/(exp(z)+1) where 
#&gt; z ~ s(x1, k = basis[1], bs = "cr") + s(x2, k = basis[2], bs = "cr") + 
#&gt;     s(x3, k = basis[3], bs = "cr")</div><div class='input'><span class='fu'><a href='EDF.gamBiCop-methods.html'>EDF</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; [1] 1.000000 1.999178 7.577543 5.665301</div><div class='input'><span class='no'>pred</span> <span class='kw'>&lt;-</span> <span class='fu'>gamBiCopPredict</span>(<span class='no'>fit</span>$<span class='no'>res</span>, <span class='no'>X</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"calib"</span>, <span class='st'>"par"</span>, <span class='st'>"tau"</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thomas Nagler, Thibault Vatter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


