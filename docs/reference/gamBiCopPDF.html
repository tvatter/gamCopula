<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conditional density function of a Generalized Additive model for the copula  
parameter or Kendall's tau — gamBiCopPDF • gamCopula</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gamCopula</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tvatter/gamCopula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conditional density function of a Generalized Additive model for the copula  
parameter or Kendall's tau</h1>
    </div>

    
    <p>This function returns the density of a bivariate conditional copula, where
either the copula parameter or the Kendall's tau is modelled as a function
of the covariates.</p>
    

    <pre class="usage"><span class='fu'>gamBiCopPDF</span>(<span class='no'>object</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code><a href='gamBiCop-class.html'>gamBiCop-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>(Same as in <code>predict.gam</code> from the 
<code><a href='http://www.rdocumentation.org/packages/mgcv/topics/mgcv-package'>mgcv</a></code> package) A matrix or data frame 
containing the values of the model covariates at which predictions are 
required. If this is not provided then the density corresponding to the 
original data are returned. If newdata is provided then it should contain all 
the variables needed for prediction: a warning is generated if not.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The conditional density.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='gamBiCop.html'>gamBiCop</a></code> and <code><a href='gamBiCopPredict.html'>gamBiCopPredict</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>require</span>(<span class='no'>copula</span>)
<span class='fu'>set.seed</span>(<span class='fl'>0</span>)

<span class='co'>## Simulation parameters (sample size, correlation between covariates,</span>
<span class='co'>## Gaussian copula family)</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>2e2</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>fam</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'>## A calibration surface depending on three variables</span>
<span class='no'>eta0</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>calib.surf</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
  <span class='no'>calib.quad</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>)/<span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> -(<span class='no'>b</span>/<span class='fl'>3</span>) * (<span class='no'>Tf</span>^<span class='fl'>2</span> - <span class='fl'>3</span> * <span class='no'>Tf</span> * <span class='no'>Tm</span> + <span class='fl'>3</span> * <span class='no'>Tm</span>^<span class='fl'>2</span>)
    <span class='fu'>return</span>(<span class='no'>a</span> + <span class='no'>b</span> * (<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span>)},
  <span class='no'>calib.sin</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>f</span> <span class='kw'>=</span> <span class='fl'>1</span>) {
    <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>b</span> * (<span class='fl'>1</span> - <span class='fl'>2</span> * <span class='no'>Tf</span> * <span class='no'>pi</span>/(<span class='no'>f</span> * <span class='no'>Tf</span> * <span class='no'>pi</span> +
                                 <span class='fu'>cos</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>Tf</span> - <span class='no'>Ti</span>))
                               - <span class='fu'>cos</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * <span class='no'>Ti</span>)))
    <span class='fu'>return</span>((<span class='no'>a</span> + <span class='no'>b</span>)/<span class='fl'>2</span> + (<span class='no'>b</span> - <span class='no'>a</span>) * <span class='fu'>sin</span>(<span class='fl'>2</span> * <span class='no'>f</span> * <span class='no'>pi</span> * (<span class='no'>t</span> - <span class='no'>Ti</span>))/<span class='fl'>2</span>)},
  <span class='no'>calib.exp</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>, <span class='no'>Ti</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>Tf</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>b</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>s</span> <span class='kw'>=</span> <span class='no'>Tf</span>/<span class='fl'>8</span>) {
    <span class='no'>Tm</span> <span class='kw'>&lt;-</span> (<span class='no'>Tf</span> - <span class='no'>Ti</span>)/<span class='fl'>2</span>
    <span class='no'>a</span> <span class='kw'>&lt;-</span> (<span class='no'>b</span> * <span class='no'>s</span> * <span class='fu'>sqrt</span>(<span class='fl'>2</span> * <span class='no'>pi</span>)/<span class='no'>Tf</span>) * (<span class='fu'>pnorm</span>(<span class='fl'>0</span>, <span class='no'>Tm</span>, <span class='no'>s</span>) - <span class='fu'>pnorm</span>(<span class='no'>Tf</span>, <span class='no'>Tm</span>, <span class='no'>s</span>))
    <span class='fu'>return</span>(<span class='no'>a</span> + <span class='no'>b</span> * <span class='fu'>exp</span>(-(<span class='no'>t</span> - <span class='no'>Tm</span>)^<span class='fl'>2</span>/(<span class='fl'>2</span> * <span class='no'>s</span>^<span class='fl'>2</span>)))})

<span class='co'>## 3-dimensional matrix X of covariates</span>
<span class='no'>covariates.distr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/Mvdc'>mvdc</a></span>(<span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/ellipCopula'>normalCopula</a></span>(<span class='no'>rho</span>, <span class='kw'>dim</span> <span class='kw'>=</span> <span class='fl'>3</span>),
                                 <span class='fu'>c</span>(<span class='st'>"unif"</span>), <span class='fu'>list</span>(<span class='fu'>list</span>(<span class='kw'>min</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>1</span>)),
                                 <span class='kw'>marginsIdentical</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/copula/topics/Mvdc'>rMvdc</a></span>(<span class='no'>n</span>, <span class='no'>covariates.distr</span>)
<span class='fu'>colnames</span>(<span class='no'>X</span>) <span class='kw'>&lt;-</span> <span class='fu'>paste</span>(<span class='st'>"x"</span>,<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)

<span class='co'>## U in [0,1]x[0,1] with copula parameter depending on X</span>
<span class='no'>U</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='condBiCopSim.html'>condBiCopSim</a></span>(<span class='no'>fam</span>, <span class='kw'>function</span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>) {<span class='no'>eta0</span>+<span class='fu'>sum</span>(<span class='fu'>mapply</span>(<span class='kw'>function</span>(<span class='no'>f</span>,<span class='no'>x</span>)
  <span class='fu'>f</span>(<span class='no'>x</span>), <span class='no'>calib.surf</span>, <span class='fu'>c</span>(<span class='no'>x1</span>,<span class='no'>x2</span>,<span class='no'>x3</span>)))}, <span class='no'>X</span>[,<span class='fl'>1</span>:<span class='fl'>3</span>], <span class='kw'>par2</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>return.par</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Merge U and X</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>U</span>$<span class='no'>data</span>,<span class='no'>X</span>)
<span class='fu'>names</span>(<span class='no'>data</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fu'>paste</span>(<span class='st'>"u"</span>,<span class='fl'>1</span>:<span class='fl'>2</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>),<span class='fu'>paste</span>(<span class='st'>"x"</span>,<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>))

<span class='co'>## Model fit with penalized cubic splines (via min GCV)</span>
<span class='no'>basis</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>3</span>, <span class='fl'>10</span>, <span class='fl'>10</span>)
<span class='no'>formula</span> <span class='kw'>&lt;-</span> ~<span class='fu'>s</span>(<span class='no'>x1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>1</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x2</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>2</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) +
  <span class='fu'>s</span>(<span class='no'>x3</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>basis</span>[<span class='fl'>3</span>], <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>)
<span class='fu'>system.time</span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gamBiCopFit.html'>gamBiCopFit</a></span>(<span class='no'>data</span>, <span class='no'>formula</span>, <span class='no'>fam</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.229   0.006   0.235 </div><div class='input'>
<span class='co'>## Evaluate the conditional density</span>
<span class='fu'>gamBiCopPDF</span>(<span class='no'>fit</span>$<span class='no'>res</span>)</div><div class='output co'>#&gt;   [1]   1.53897409   0.65895255   7.54308919   7.29902794   7.98200466
#&gt;   [6]   0.91280983   0.65051146   1.08273677   0.13773165   8.67048283
#&gt;  [11]   4.95057615   3.20943703   1.00633039   0.84382926   0.40244706
#&gt;  [16]   2.76005256   1.96292286  11.68003966   1.47383017   1.07385649
#&gt;  [21]   0.99519798   1.18493994   1.44425297   0.83340597   2.40090338
#&gt;  [26]   6.05695932   1.41528126   3.00012259   1.74635340   0.89680036
#&gt;  [31]  10.49237658   1.42704608   1.01410397   1.20991114   0.31228006
#&gt;  [36]   1.94781172   1.08920172  10.33179260   0.96340114   1.10652903
#&gt;  [41]   1.19280224   1.53050049   1.15345886   1.49250150   3.65567450
#&gt;  [46]   1.15697132  10.71967518   0.69294323   1.64953687   1.04327879
#&gt;  [51]  88.38436240   3.62295213  10.47617993   0.77327325   2.40824831
#&gt;  [56]   0.08006449   1.37469193   3.00543370   0.85171208   1.12234724
#&gt;  [61]   1.60635642   0.83929746   2.41797654   0.81561166   4.07324027
#&gt;  [66]  32.31728518   0.77131922   1.03527579   2.91140932   2.50619363
#&gt;  [71]   1.14147003   1.34993051   5.42784075   1.65326684   1.27372418
#&gt;  [76]   1.50209872   1.03634247   1.00381308   1.44370479   5.84889100
#&gt;  [81]   5.19282176   0.76370453 100.00992066   2.79801297   1.26603622
#&gt;  [86]   0.99666029   5.95339495   0.77555019   1.29134500   0.85042384
#&gt;  [91]   1.68855016  13.22072485   1.30870031   1.09627773   0.98611410
#&gt;  [96]   1.64269684   1.25826086  18.73796411   1.26322251   1.20958580
#&gt; [101]   1.14939531   0.56989490   1.78403902   1.20540159   9.17700886
#&gt; [106]   1.86256652   2.08354774   1.27445574   0.81208319   1.09719242
#&gt; [111]   0.70119548   1.42652282   1.74619315  31.69259035   1.57919837
#&gt; [116]   0.07155906   3.75765970   1.06833619   1.06277686   2.75424876
#&gt; [121]   1.03289717   0.98409803   1.06658308   4.13468165   1.43183856
#&gt; [126]   1.14460591   1.62000488   1.72714023   1.29943373   2.45416520
#&gt; [131]   1.39534538   1.55503242  10.17514164   1.39641877   0.96021880
#&gt; [136]   6.23700638   0.96829628   2.18752443   1.04595150   1.03916368
#&gt; [141]   0.31373842   1.91360632   1.04706871   1.27716309  12.45134113
#&gt; [146]   0.55571760   1.05842882   1.18931050   1.15449172   2.97966281
#&gt; [151]   0.98788715   2.10243551   1.19538471   1.03388254   0.75967887
#&gt; [156]   0.91491599   0.61518975   5.93053002   1.03114386   2.00393186
#&gt; [161]  22.53256040   0.96323476   7.46971594   1.82261251   2.34808682
#&gt; [166]   2.74248586   1.36414169   3.88879034   1.18696751   1.61579038
#&gt; [171]   1.49307845  88.82655883   1.35422005   0.95393911   1.77950413
#&gt; [176]   0.91590531   2.24707243   3.45363709   3.73011797  11.21433096
#&gt; [181]   1.21093188   2.96206743   5.20979379   1.41870963   4.06028494
#&gt; [186]   0.82568046   1.28401255   1.14938890   6.06026205   7.85370444
#&gt; [191]   1.55187793   2.27710006   1.03309736   1.98248935   2.15382610
#&gt; [196]   1.10177792   1.62369088   2.79315172   2.37038226   0.62678583</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas Nagler, Thibault Vatter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
